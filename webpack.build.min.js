var config = require('./webpack.build.js')
var webpack = require('webpack')
var OptimizeCssAssetsPlugin = require('optimize-css-assets-webpack-plugin');
const ExtractTextPlugin = require('extract-text-webpack-plugin');
config.output.filename = config.output.filename.replace(/\.js$/, '.min.js')

delete config.devtool

config.plugins.push(
  new webpack.optimize.UglifyJsPlugin({
    sourceMap: false,
    drop_console: true,
    compress: {
        warnings: false
    }
  }),
  new ExtractTextPlugin('dist/vue-strap.min.css', {
    allChunks: true,
  }),
  new OptimizeCssAssetsPlugin({
    assetNameRegExp:/\.min\.css$/g,
    cssProcessor: require('cssnano'),
    cssProcessorOptions: { discardComments: {removeAll: true } },
    canPrint: true
  })
)

module.exports = config
